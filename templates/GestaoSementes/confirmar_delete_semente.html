{% extends "Siderbar/base_sidebar.html" %}
{% load static %}

{% block title %}Confirmar Exclusão de Semente{% endblock %}
{% block body_class %}sementes-active{% endblock %}

{% block content %}

<div class="delete-confirmation-page">
    <div class="confirmation-card">

        <div class="delete-content">
            <h1 class="main-title">
                Excluir: "<span class="highlight-name">{{ semente.nome }}</span>"
            </h1>

            {% if lotes %}
                <div class="delete-warning">
                    <p>
                        <i class="bi bi-exclamation-octagon-fill"></i>
                        <strong>ATENÇÃO!</strong> Esta semente está 
                        <strong>associada a {{ lotes|length }} lotes</strong>.
                        A exclusão da semente afetará todos os registros abaixo.
                    </p>
                </div>

                <h2 class="lotes-subtitle">Lotes associados:</h2>

                <ul class="lotes-list-details">
                    {% for lote in lotes %}
                        <li>
                            <strong>Lote #{{ lote.idlote }}</strong> — 
                            Peso: {{ lote.peso }} kg —
                            Armazém: 
                            <span class="armazem-name-small">
                                {{ lote.armazem_idarmazem.nome }}
                            </span>
                        </li>
                    {% endfor %}
                </ul>

                <form method="post" class="delete-form">
                    {% csrf_token %}
                    
                    <label class="confirmation-checkbox-label">
                        <input type="checkbox" name="apagar_lotes" value="sim" required>
                        Confirmo que desejo 
                        <strong>excluir permanentemente</strong> 
                        a semente e todos os {{ lotes|length }} lotes associados.
                    </label>

                    <div class="action-buttons-group">
                        <button type="submit" class="btn-app btn-delete-confirm">
                            <i class="bi bi-trash-fill"></i> Excluir Definitivamente
                        </button>

                        <a href="{% url 'detalhes_semente' semente.idtiposemente %}" 
                           class="btn-app btn-cancel">
                            Cancelar
                        </a>
                    </div>
                </form>

            {% else %}

                <p class="no-lotes-info">
                    <i class="bi bi-question-circle-fill"></i>
                    Esta semente não possui lotes associados.  
                    Deseja prosseguir com a exclusão de 
                    "<strong>{{ semente.nome }}</strong>"?
                </p>

                <form method="post" class="delete-form">
                    {% csrf_token %}
                    <div class="action-buttons-group">
                        <button type="submit" class="btn-app btn-delete-confirm">
                            <i class="bi bi-trash-fill"></i> Excluir Semente
                        </button>

                        <a href="{% url 'detalhes_semente' semente.idtiposemente %}" 
                           class="btn-app btn-cancel">
                            Cancelar
                        </a>
                    </div>
                </form>

            {% endif %}
        </div>

        <img src="{% static 'img/fazendeiro.svg' %}" 
             class="mascote-image" 
             alt="Mascote Agro">
             
    </div>
</div>

{% endblock %}
